<%- include("./partials/header", {title: "Profile"}) %>
<main>
  <section class="py-12 sm:py-16">
    <div class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8">
      <div
        class="flex flex-col items-center gap-y-4 sm:flex-row sm:gap-x-3 bg-neutral-800 border-[1px] border-neutral-700 rounded-xl p-4"
      >
        <img
          src="<%= user.photo %>"
          alt="Your profile picture"
          class="rounded-full w-20 h-20 sm:w-12 sm:h-12 inline ring-4"
        />
        <div>
          <h1 class="text-white text-3xl font-semibold"><%= user.name %></h1>
          <p class="text-center sm:text-left text-xs">
            <a
              href="/user/profile/settings"
              class="btn-outline px-2 rounded-full"
            >
              Settings
            </a>
          </p>
        </div>
      </div>

      <div
        class="flex flex-col gap-4 sm:flex-row sm:gap-12 text-neutral-50 bg-neutral-800 border-[1px] border-neutral-700 border-t-0 rounded p-4"
      >
        <div class="sm:border-r-2 border-neutral-500 sm:pr-4">
          <h4 class="text-sm text-neutral-300">Email:</h4>
          <p><%= user.email %></p>
        </div>

        <div class="sm:border-r-2 border-neutral-500 sm:pr-4">
          <h4 class="text-sm text-neutral-300">Joined:</h4>
          <p><%= user.createdAt.toDateString() %></p>
        </div>

        <div>
          <h4 class="text-sm text-neutral-300">Account Status:</h4>
          <p><%= user.verified ? "Approved" : "Pending" %></p>
        </div>
      </div>

      <div
        class="bg-neutral-800 border-[1px] border-neutral-700 rounded p-4 mt-8"
      >
        <h3
          class="font-semibold border-b-[1px] border-neutral-700 pb-2 text-neutral-400"
        >
          About
        </h3>
        <p class="pt-3 max-w-3xl text-neutral-200"><%= user.bio %></p>
      </div>

      <div
        class="bg-neutral-800 border-[1px] border-neutral-700 rounded p-4 mt-8 text-neutral-200"
      >
        <h3
          class="font-semibold border-b-[1px] border-neutral-700 pb-2 text-neutral-400"
        >
          Posts
        </h3>
        <p class="mt-2 text-neutral-300 text-sm">
          Recent blog posts that you've published,
          <a href="/user/posts/new" class="hover:underline">click here</a>
          to create a new blog post.
        </p>

        <% if (posts.length === 0) { %>
        <p class="pt-3 max-w-3xl">
          You have not posted yet, start by
          <a href="/user/posts/new" class="underline">creating a post.</a>
        </p>
        <% } else { %>
        <div class="overflow-x-auto mt-4">
          <table class="min-w-full divide-y-2 divide-neutral-700 text-sm">
            <thead>
              <tr class="text-left">
                <th
                  class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                >
                  #
                </th>

                <th
                  class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                >
                  Title
                </th>

                <th class="px-4 py-2"></th>
              </tr>
            </thead>

            <tbody class="divide-y divide-neutral-700">
              <% posts.forEach((post, index) => { %>
              <tr class="text-left">
                <td class="whitespace-nowrap px-4 py-2 text-neutral-300">
                  <%= index + 1 %>
                </td>

                <td class="whitespace-nowrap px-4 py-2">
                  <a href="/user/posts/<%= post.id %>" class="text-neutral-200">
                    <%= post.title %>
                  </a>
                </td>

                <td class="whitespace-nowrap px-4 py-2">
                  <a
                    href="/user/posts/<%= post.id %>"
                    class="btn-primary inline-block px-4 py-1 text-xs font-semibold rounded-full"
                    >View</a
                  >
                </td>
              </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
        <% } %>
      </div>

      <div
        class="bg-neutral-800 border-[1px] border-neutral-700 rounded p-4 mt-8 text-neutral-200"
      >
        <h3
          class="text-neutral-400 font-semibold border-b-[1px] border-neutral-700 pb-2"
        >
          Jobs
        </h3>

        <div
          class="bg-neutral-800 border-[1px] border-neutral-700 rounded-md p-4 mt-8"
        >
          <h3
            class="font-semibold border-b-[1px] border-neutral-700 pb-2 text-neutral-400"
          >
            Recently Posted Jobs
          </h3>

          <p class="mt-2 text-neutral-300 text-sm">
            These are some recently posted jobs, to view all jobs available
            <a href="/jobs" class="">click here.</a>
          </p>

          <% if (recentJobs.length > 0) { %>
          <div class="overflow-x-auto mt-2">
            <table class="min-w-full divide-y-2 divide-neutral-700 text-sm">
              <thead>
                <tr class="text-left">
                  <th
                    class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                  >
                    #
                  </th>

                  <th
                    class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                  >
                    Title
                  </th>

                  <th
                    class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                  >
                    Location
                  </th>

                  <th
                    class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                  >
                    Type
                  </th>

                  <th
                    class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                  >
                    Workplace
                  </th>

                  <th
                    class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                  >
                    Company
                  </th>

                  <th class="px-4 py-2"></th>
                </tr>
              </thead>

              <tbody class="divide-y divide-neutral-700">
                <% recentJobs.forEach((job, index) => { %>
                <tr class="text-left">
                  <td class="whitespace-nowrap px-4 py-2 text-neutral-300">
                    <%= index + 1 %>
                  </td>

                  <td class="whitespace-nowrap px-4 py-2">
                    <a href="/jobs/<%= job.id %>" class="text-neutral-200">
                      <%= job.title %>
                    </a>
                  </td>

                  <td class="whitespace-nowrap px-4 py-2 text-neutral-200">
                    <%= job.location %>
                  </td>

                  <td class="whitespace-nowrap px-4 py-2 text-neutral-200">
                    <%= job.type == "partTime" ? "Part-time" : job.type ==
                    "fullTime" ? "Full-time" : job.type %>
                  </td>

                  <td class="whitespace-nowrap px-4 py-2 text-neutral-200">
                    <%= job.workplace == "onSite" ? "on-site" : job.workplace %>
                  </td>

                  <td class="whitespace-nowrap px-4 py-2 text-neutral-200">
                    <%= job.company %>
                  </td>

                  <td class="whitespace-nowrap px-4 py-2">
                    <a
                      href="/jobs/<%= job.id %>"
                      class="btn-primary inline-block px-4 py-1 text-xs font-medium rounded-full"
                      >View</a
                    >
                  </td>
                </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
          <% } else { %>
          <p class="mt-3 text-neutral-300">
            Currently there are no jobs available, please check back later.
          </p>
          <% } %>
        </div>

        <div
          class="bg-neutral-800 border-[1px] border-neutral-700 rounded-md p-4 mt-8"
        >
          <h3
            class="font-semibold border-b-[1px] border-neutral-700 text-neutral-500 pb-2"
          >
            Applied Jobs
          </h3>

          <p class="mt-2 text-neutral-300 text-sm">
            These are jobs that you've applied, to view more jobs please
            <a href="/jobs" class="text-golden hover:underline">click here.</a>
          </p>

          <% if (jobsApplied.length > 0) { %>
          <div class="overflow-x-auto mt-2">
            <table class="min-w-full divide-y-2 divide-neutral-700 text-sm">
              <thead>
                <tr class="text-left">
                  <th
                    class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                  >
                    #
                  </th>

                  <th
                    class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                  >
                    Title
                  </th>

                  <th
                    class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                  >
                    Location
                  </th>

                  <th
                    class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                  >
                    Type
                  </th>

                  <th
                    class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                  >
                    Workplace
                  </th>

                  <th
                    class="whitespace-nowrap px-4 py-2 font-semibold text-neutral-500"
                  >
                    Company
                  </th>

                  <th class="px-4 py-2"></th>
                </tr>
              </thead>

              <tbody class="divide-y divide-neutral-700">
                <% jobsApplied.forEach((job, index) => { %>
                <tr class="text-left">
                  <td class="whitespace-nowrap px-4 py-2 text-neutral-300">
                    <%= index + 1 %>
                  </td>

                  <td class="whitespace-nowrap px-4 py-2">
                    <a href="/jobs/<%= job.id %>" class="text-neutral-200">
                      <%= job.title %>
                    </a>
                  </td>

                  <td class="whitespace-nowrap px-4 py-2 text-neutral-200">
                    <%= job.location %>
                  </td>

                  <td class="whitespace-nowrap px-4 py-2 text-neutral-200">
                    <%= job.type == "partTime" ? "Part-time" : job.type ==
                    "fullTime" ? "Full-time" : job.type %>
                  </td>

                  <td class="whitespace-nowrap px-4 py-2 text-neutral-200">
                    <%= job.workplace == "onSite" ? "on-site" : job.workplace %>
                  </td>

                  <td class="whitespace-nowrap px-4 py-2 text-neutral-200">
                    <%= job.company %>
                  </td>

                  <td class="whitespace-nowrap px-4 py-2">
                    <a
                      href="/jobs/<%= job.id %>"
                      class="btn-primary inline-block px-4 py-1 text-xs font-semibold rounded-full"
                      >View</a
                    >
                  </td>
                </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
          <% } else { %>
          <p class="mt-3 text-neutral-300">
            You haven't applied to any job yet.
          </p>
          <% } %>
        </div>

        <p class="mt-8 text-right text-sm">
          Go to
          <a href="/user/profile/settings" class="btn-outline px-3 py-1 ml-1"
            >Profile Settings</a
          >
        </p>
      </div>
    </div>
  </section>
</main>
<%- include("./partials/footer") %>
